<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>PersistenceDelegate (Java SE 17 &amp; JDK 17 [build 3])</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: module: java.desktop, package: java.beans, class: PersistenceDelegate">
<meta name="generator" content="javadoc/ClassWriterImpl">
<meta name="keywords" content="java.beans.PersistenceDelegate class">
<meta name="keywords" content="writeObject()">
<meta name="keywords" content="mutatesTo()">
<meta name="keywords" content="instantiate()">
<meta name="keywords" content="initialize()">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header"><div style="padding: 6px; text-align: center; font-size: 80%; font-family: DejaVu Sans, Arial, Helvetica, sans-serif; font-weight: normal;">This specification is not final and is subject to change. Use is subject to <a href="https://www.oracle.com/java/javase/terms/license/java17speclicense.html">license terms</a>.</div>
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><div style="margin-top: 9px;"><strong>Java SE 17 &amp; JDK 17</strong> <br><strong>DRAFT 17-crac+3-15</strong></div></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/PersistenceDelegate.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../preview-list.html">Preview</a></li>
<li><a href="../../../new-list.html">New</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../module-summary.html">java.desktop</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">java.beans</a></div>
<h1 title="Class PersistenceDelegate" class="title">Class PersistenceDelegate</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="../../../java.base/java/lang/Object.html" title="class in java.lang">java.lang.Object</a>
<div class="inheritance">java.beans.PersistenceDelegate</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="DefaultPersistenceDelegate.html" title="class in java.beans">DefaultPersistenceDelegate</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">PersistenceDelegate</span>
<span class="extends-implements">extends <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a></span></div>
<div class="block">The PersistenceDelegate class takes the responsibility
 for expressing the state of an instance of a given class
 in terms of the methods in the class's public API. Instead
 of associating the responsibility of persistence with
 the class itself as is done, for example, by the
 <code>readObject</code> and <code>writeObject</code>
 methods used by the <code>ObjectOutputStream</code>, streams like
 the <code>XMLEncoder</code> which
 use this delegation model can have their behavior controlled
 independently of the classes themselves. Normally, the class
 is the best place to put such information and conventions
 can easily be expressed in this delegation scheme to do just that.
 Sometimes however, it is the case that a minor problem
 in a single class prevents an entire object graph from
 being written and this can leave the application
 developer with no recourse but to attempt to shadow
 the problematic classes locally or use alternative
 persistence techniques. In situations like these, the
 delegation model gives a relatively clean mechanism for
 the application developer to intervene in all parts of the
 serialization process without requiring that modifications
 be made to the implementation of classes which are not part
 of the application itself.
 <p>
 In addition to using a delegation model, this persistence
 scheme differs from traditional serialization schemes
 in requiring an analog of the <code>writeObject</code>
 method without a corresponding <code>readObject</code>
 method. The <code>writeObject</code> analog encodes each
 instance in terms of its public API and there is no need to
 define a <code>readObject</code> analog
 since the procedure for reading the serialized form
 is defined by the semantics of method invocation as laid
 out in the Java Language Specification.
 Breaking the dependency between <code>writeObject</code>
 and <code>readObject</code> implementations, which may
 change from version to version, is the key factor
 in making the archives produced by this technique immune
 to changes in the private implementations of the classes
 to which they refer.
 <p>
 A persistence delegate, may take control of all
 aspects of the persistence of an object including:
 <ul>
 <li>
 Deciding whether or not an instance can be mutated
 into another instance of the same class.
 <li>
 Instantiating the object, either by calling a
 public constructor or a public factory method.
 <li>
 Performing the initialization of the object.
 </ul></div>
<dl class="notes">
<dt>Since:</dt>
<dd>1.4</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="XMLEncoder.html" title="class in java.beans"><code>XMLEncoder</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">PersistenceDelegate</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Constructs a <code>PersistenceDelegate</code>.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initialize(java.lang.Class,java.lang.Object,java.lang.Object,java.beans.Encoder)" class="member-name-link">initialize</a><wbr>(<a href="../../../java.base/java/lang/Class.html" title="class in java.lang">Class</a>&lt;?&gt;&nbsp;type,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;newInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Produce a series of statements with side effects on <code>newInstance</code>
 so that the new instance becomes <em>equivalent</em> to <code>oldInstance</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract <a href="Expression.html" title="class in java.beans">Expression</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#instantiate(java.lang.Object,java.beans.Encoder)" class="member-name-link">instantiate</a><wbr>(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns an expression whose value is <code>oldInstance</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#mutatesTo(java.lang.Object,java.lang.Object)" class="member-name-link">mutatesTo</a><wbr>(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;newInstance)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns true if an <em>equivalent</em> copy of <code>oldInstance</code> may be
 created by applying a series of statements to <code>newInstance</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeObject(java.lang.Object,java.beans.Encoder)" class="member-name-link">writeObject</a><wbr>(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The <code>writeObject</code> is a single entry point to the persistence
 and is used by an <code>Encoder</code> in the traditional
 mode of delegation.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class&nbsp;java.lang.<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a></h3>
<code><a href="../../../java.base/java/lang/Object.html#clone()">clone</a>, <a href="../../../java.base/java/lang/Object.html#equals(java.lang.Object)">equals</a>, <a href="../../../java.base/java/lang/Object.html#finalize()">finalize</a>, <a href="../../../java.base/java/lang/Object.html#getClass()">getClass</a>, <a href="../../../java.base/java/lang/Object.html#hashCode()">hashCode</a>, <a href="../../../java.base/java/lang/Object.html#notify()">notify</a>, <a href="../../../java.base/java/lang/Object.html#notifyAll()">notifyAll</a>, <a href="../../../java.base/java/lang/Object.html#toString()">toString</a>, <a href="../../../java.base/java/lang/Object.html#wait()">wait</a>, <a href="../../../java.base/java/lang/Object.html#wait(long)">wait</a>, <a href="../../../java.base/java/lang/Object.html#wait(long,int)">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>PersistenceDelegate</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="element-name">PersistenceDelegate</span>()</div>
<div class="block">Constructs a <code>PersistenceDelegate</code>.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="writeObject(java.lang.Object,java.beans.Encoder)">
<h3>writeObject</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeObject</span><wbr><span class="parameters">(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</span></div>
<div class="block">The <code>writeObject</code> is a single entry point to the persistence
 and is used by an <code>Encoder</code> in the traditional
 mode of delegation. Although this method is not final,
 it should not need to be subclassed under normal circumstances.
 <p>
 This implementation first checks to see if the stream
 has already encountered this object. Next the
 <code>mutatesTo</code> method is called to see if
 that candidate returned from the stream can
 be mutated into an accurate copy of <code>oldInstance</code>.
 If it can, the <code>initialize</code> method is called to
 perform the initialization. If not, the candidate is removed
 from the stream, and the <code>instantiate</code> method
 is called to create a new candidate for this object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>oldInstance</code> - The instance that will be created by this expression.</dd>
<dd><code>out</code> - The stream to which this expression will be written.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../../java.base/java/lang/NullPointerException.html" title="class in java.lang">NullPointerException</a></code> - if <code>out</code> is <code>null</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="mutatesTo(java.lang.Object,java.lang.Object)">
<h3>mutatesTo</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">mutatesTo</span><wbr><span class="parameters">(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;newInstance)</span></div>
<div class="block">Returns true if an <em>equivalent</em> copy of <code>oldInstance</code> may be
 created by applying a series of statements to <code>newInstance</code>.
 In the specification of this method, we mean by equivalent that the modified instance
 is indistinguishable from <code>oldInstance</code> in the behavior
 of the relevant methods in its public API. [Note: we use the
 phrase <em>relevant</em> methods rather than <em>all</em> methods
 here only because, to be strictly correct, methods like <code>hashCode</code>
 and <code>toString</code> prevent most classes from producing truly
 indistinguishable copies of their instances].
 <p>
 The default behavior returns <code>true</code>
 if the classes of the two instances are the same.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>oldInstance</code> - The instance to be copied.</dd>
<dd><code>newInstance</code> - The instance that is to be modified.</dd>
<dt>Returns:</dt>
<dd>True if an equivalent copy of <code>newInstance</code> may be
         created by applying a series of mutations to <code>oldInstance</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="instantiate(java.lang.Object,java.beans.Encoder)">
<h3>instantiate</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type"><a href="Expression.html" title="class in java.beans">Expression</a></span>&nbsp;<span class="element-name">instantiate</span><wbr><span class="parameters">(<a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</span></div>
<div class="block">Returns an expression whose value is <code>oldInstance</code>.
 This method is used to characterize the constructor
 or factory method that should be used to create the given object.
 For example, the <code>instantiate</code> method of the persistence
 delegate for the <code>Field</code> class could be defined as follows:
 <pre>
 Field f = (Field)oldInstance;
 return new Expression(f, f.getDeclaringClass(), "getField", new Object[]{f.getName()});
 </pre>
 Note that we declare the value of the returned expression so that
 the value of the expression (as returned by <code>getValue</code>)
 will be identical to <code>oldInstance</code>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>oldInstance</code> - The instance that will be created by this expression.</dd>
<dd><code>out</code> - The stream to which this expression will be written.</dd>
<dt>Returns:</dt>
<dd>An expression whose value is <code>oldInstance</code>.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../../java.base/java/lang/NullPointerException.html" title="class in java.lang">NullPointerException</a></code> - if <code>out</code> is <code>null</code>
                              and this value is used in the method</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initialize(java.lang.Class,java.lang.Object,java.lang.Object,java.beans.Encoder)">
<h3>initialize</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initialize</span><wbr><span class="parameters">(<a href="../../../java.base/java/lang/Class.html" title="class in java.lang">Class</a>&lt;?&gt;&nbsp;type,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;oldInstance,
 <a href="../../../java.base/java/lang/Object.html" title="class in java.lang">Object</a>&nbsp;newInstance,
 <a href="Encoder.html" title="class in java.beans">Encoder</a>&nbsp;out)</span></div>
<div class="block">Produce a series of statements with side effects on <code>newInstance</code>
 so that the new instance becomes <em>equivalent</em> to <code>oldInstance</code>.
 In the specification of this method, we mean by equivalent that, after the method
 returns, the modified instance is indistinguishable from
 <code>newInstance</code> in the behavior of all methods in its
 public API.
 <p>
 The implementation typically achieves this goal by producing a series of
 "what happened" statements involving the <code>oldInstance</code>
 and its publicly available state. These statements are sent
 to the output stream using its <code>writeExpression</code>
 method which returns an expression involving elements in
 a cloned environment simulating the state of an input stream during
 reading. Each statement returned will have had all instances
 the old environment replaced with objects which exist in the new
 one. In particular, references to the target of these statements,
 which start out as references to <code>oldInstance</code> are returned
 as references to the <code>newInstance</code> instead.
 Executing these statements effects an incremental
 alignment of the state of the two objects as a series of
 modifications to the objects in the new environment.
 By the time the initialize method returns it should be impossible
 to tell the two instances apart by using their public APIs.
 Most importantly, the sequence of steps that were used to make
 these objects appear equivalent will have been recorded
 by the output stream and will form the actual output when
 the stream is flushed.
 <p>
 The default implementation, calls the <code>initialize</code>
 method of the type's superclass.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>type</code> - the type of the instances</dd>
<dd><code>oldInstance</code> - The instance to be copied.</dd>
<dd><code>newInstance</code> - The instance that is to be modified.</dd>
<dd><code>out</code> - The stream to which any initialization statements should be written.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../../java.base/java/lang/NullPointerException.html" title="class in java.lang">NullPointerException</a></code> - if <code>out</code> is <code>null</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><a href="https://bugreport.java.com/bugreport/">Report a bug or suggest an enhancement</a><br> For further API reference and developer documentation see the <a href="https://docs.oracle.com/pls/topic/lookup?ctx=javase17&amp;id=homepage" target="_blank">Java SE Documentation</a>, which contains more detailed, developer-targeted descriptions with conceptual overviews, definitions of terms, workarounds, and working code examples. <a href="https://docs.oracle.com/en/java/javase/index.html">Other versions.</a><br> Java is a trademark or registered trademark of Oracle and/or its affiliates in the US and other countries.<br> <a href="../../../../legal/copyright.html">Copyright</a> &copy; 1993, 2022, Oracle and/or its affiliates, 500 Oracle Parkway, Redwood Shores, CA 94065 USA.<br>All rights reserved. Use is subject to <a href="https://www.oracle.com/java/javase/terms/license/java17speclicense.html">license terms</a> and the <a href="https://www.oracle.com/technetwork/java/redist-137594.html">documentation redistribution policy</a>. <br><strong>DRAFT 17-crac+3-15</strong> <!-- Version 17-crac+3-15 --></small></p>
</footer>
</div>
</div>
</body>
</html>
